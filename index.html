<!DOCTYPE html>
<html manifest="/manifest.appcache">
<head><meta charset="utf-8">
<title>bigtex</title>
<meta name="author" content="Stuart P. Bentley">
<link rel="author" href="http://stuartpb.com">
<link rel="repo" href="https://github.com/stuartpb/bigtex">
<style>
html, body {
  margin: 0;
  height: 100%;
  width: 100%;
  text-align: center;
}
.inverted {
  background-color: #000;
  color: #fff;
}
body::before {
  content: '';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
}
main {
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  font: 7em sans-serif;
  outline: none;
}
</style></head>
<body><main id="main" contenteditable="true"></main><script>
/* global getSelection */
var mainEl = document.getElementById('main');
function setEditable() {
  mainEl.contentEditable = true;
  document.body.firstChild.focus();
}
function unsetEditable() {
  if (mainEl.textContent.length) mainEl.contentEditable = false;
}
document.body.addEventListener('click',setEditable); setEditable();
function flashOn(evt) {
  var focusPosition = getSelection().focusOffset;
  var nodeLength = getSelection().focusNode.length;
  if (((evt.keyCode == 37 || evt.keyCode == 38)
      && focusPosition == 0) ||
    ((evt.keyCode == 39 || evt.keyCode == 40)
      && focusPosition == nodeLength)) {
    unsetEditable();
    document.body.classList.add('inverted');
  } else setEditable();
}
document.body.addEventListener('keydown',flashOn);
function flashOff(evt) {
  document.body.classList.remove('inverted');
  unsetEditable();
}
document.body.addEventListener('keyup',flashOff);
</script></body></html>
